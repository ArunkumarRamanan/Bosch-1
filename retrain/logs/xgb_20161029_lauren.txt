this is fold 1
[0]	train-auc:0.676997	val-auc:0.681376
Multiple eval metrics have been passed: 'val-auc' will be used for early stopping.

Will train until val-auc hasn't improved in 20 rounds.
[10]	train-auc:0.751574	val-auc:0.730882
[20]	train-auc:0.774221	val-auc:0.737723
[30]	train-auc:0.795805	val-auc:0.742704
[40]	train-auc:0.81479	val-auc:0.745858
[50]	train-auc:0.827386	val-auc:0.74656
[60]	train-auc:0.841608	val-auc:0.747874
[70]	train-auc:0.850519	val-auc:0.748913
[80]	train-auc:0.861444	val-auc:0.750646
[90]	train-auc:0.86781	val-auc:0.752323
[100]	train-auc:0.874038	val-auc:0.752361
[110]	train-auc:0.880897	val-auc:0.752468
[120]	train-auc:0.886178	val-auc:0.752501
Stopping. Best iteration:
[101]	train-auc:0.874643	val-auc:0.752665

xgb mcc: 0.299871318342
the auc is 0.752343235476
the best threshold is 0.28087
the auc is 0.741556631776
rf mcc: 0.230843297429
the best threshold is 0.142368060997
final mcc: 0.294969714634
the auc is 0.753297260094
the best threshold is 0.187044938278
[('L3_S30_F3804', 216), ('L3_S33_F3857', 211), ('L3_S30_F3759', 207), ('L3_S30_F3754', 193), ('L3_S30_F3774', 186), ('L3_S30_F3744', 181), ('L3_S30_F3809', 180), ('L3_S36_F3920', 175), ('L3_S33_F3865', 170), ('L3_S30_F3749', 166), ('L3_S29_F3395', 160), ('L0_S0_F20', 151), ('L3_S30_F3769', 149), ('L3_S30_F3554', 148), ('S38_StationTiming', 143), ('S30_Mean', 139), ('L3_S29_F3336', 137), ('L3_S29_F3479', 137), ('L0_S1_F28', 126)]
this is fold 2
[0]	train-auc:0.689861	val-auc:0.684928
Multiple eval metrics have been passed: 'val-auc' will be used for early stopping.

Will train until val-auc hasn't improved in 20 rounds.
[10]	train-auc:0.74453	val-auc:0.721824
[20]	train-auc:0.770592	val-auc:0.731749
[30]	train-auc:0.795045	val-auc:0.740646
[40]	train-auc:0.811294	val-auc:0.74237
[50]	train-auc:0.828938	val-auc:0.743964
[60]	train-auc:0.840419	val-auc:0.744823
[70]	train-auc:0.853562	val-auc:0.746456
[80]	train-auc:0.861464	val-auc:0.747934
[90]	train-auc:0.869684	val-auc:0.7492
[100]	train-auc:0.876954	val-auc:0.750318
[110]	train-auc:0.883016	val-auc:0.751556
[120]	train-auc:0.889614	val-auc:0.753078
[130]	train-auc:0.895765	val-auc:0.752856
[140]	train-auc:0.901932	val-auc:0.752562
[150]	train-auc:0.905209	val-auc:0.753229
[160]	train-auc:0.910466	val-auc:0.753732
[170]	train-auc:0.915448	val-auc:0.754278
[180]	train-auc:0.920237	val-auc:0.7549
[190]	train-auc:0.923345	val-auc:0.754949
xgb mcc: 0.263641212363
the auc is 0.755269370072
the best threshold is 0.214559
the auc is 0.736878573559
rf mcc: 0.212402020964
the best threshold is 0.145265938872
final mcc: 0.26321595746
the auc is 0.757082244409
the best threshold is 0.19445695244
[('L3_S30_F3759', 351), ('L3_S30_F3754', 347), ('L3_S33_F3857', 347), ('L3_S33_F3859', 332), ('L3_S30_F3744', 300), ('L3_S30_F3809', 294), ('L3_S30_F3554', 289), ('L3_S30_F3804', 267), ('L3_S30_F3749', 262), ('L0_S0_F20', 252), ('L3_S33_F3865', 251), ('L3_S36_F3920', 251), ('L3_S29_F3395', 250), ('L3_S29_F3479', 249), ('L3_S30_F3769', 226), ('L0_S1_F28', 216), ('L3_S30_F3519', 201), ('L3_S29_F3336', 200), ('S37_Time0', 199)]
this is fold 3
[0]	train-auc:0.674792	val-auc:0.668566
Multiple eval metrics have been passed: 'val-auc' will be used for early stopping.

Will train until val-auc hasn't improved in 20 rounds.
[10]	train-auc:0.749758	val-auc:0.70684
[20]	train-auc:0.774643	val-auc:0.719619
[30]	train-auc:0.80799	val-auc:0.729313
[40]	train-auc:0.819155	val-auc:0.733398
[50]	train-auc:0.833823	val-auc:0.735052
[60]	train-auc:0.845244	val-auc:0.736329
[70]	train-auc:0.855395	val-auc:0.736502
[80]	train-auc:0.864717	val-auc:0.737332
[90]	train-auc:0.873395	val-auc:0.737276
[100]	train-auc:0.879474	val-auc:0.738771
[110]	train-auc:0.88597	val-auc:0.739361
[120]	train-auc:0.890207	val-auc:0.738913
[130]	train-auc:0.896403	val-auc:0.738316
Stopping. Best iteration:
[112]	train-auc:0.886628	val-auc:0.739469

xgb mcc: 0.270729678351
the auc is 0.738257834303
the best threshold is 0.331323
the auc is 0.723919806079
rf mcc: 0.209022534338
the best threshold is 0.171012897189
final mcc: 0.272432982214
the auc is 0.740283388179
the best threshold is 0.230355385217
[('L3_S33_F3857', 252), ('L3_S30_F3759', 244), ('L3_S30_F3809', 212), ('L3_S30_F3749', 208), ('L3_S30_F3754', 204), ('L3_S30_F3804', 204), ('L3_S30_F3774', 199), ('L3_S33_F3865', 198), ('L3_S30_F3744', 196), ('L0_S0_F20', 194), ('L3_S30_F3554', 180), ('L3_S36_F3920', 174), ('L3_S29_F3479', 168), ('L0_S1_F28', 158), ('L3_S29_F3339', 154), ('L3_S30_F3769', 153), ('L3_S29_F3395', 152), ('S38_StationTiming', 140), ('S37_Time0', 138)]
this is fold 4
[0]	train-auc:0.676346	val-auc:0.662251
Multiple eval metrics have been passed: 'val-auc' will be used for early stopping.

Will train until val-auc hasn't improved in 20 rounds.
[10]	train-auc:0.758021	val-auc:0.714621
[20]	train-auc:0.779238	val-auc:0.723997
[30]	train-auc:0.797992	val-auc:0.729947
[40]	train-auc:0.814739	val-auc:0.73465
[50]	train-auc:0.825706	val-auc:0.737644
[60]	train-auc:0.835288	val-auc:0.737622
[70]	train-auc:0.843822	val-auc:0.73807
[80]	train-auc:0.85208	val-auc:0.73827
[90]	train-auc:0.861371	val-auc:0.740386
[100]	train-auc:0.868791	val-auc:0.741656
[110]	train-auc:0.877446	val-auc:0.741716
[120]	train-auc:0.885683	val-auc:0.741581
Stopping. Best iteration:
[105]	train-auc:0.873577	val-auc:0.741944

xgb mcc: 0.258373256305
the auc is 0.741547962399
the best threshold is 0.131395
the auc is 0.72449445746
rf mcc: 0.207414109301
the best threshold is 0.0924977640273
final mcc: 0.255052487667
the auc is 0.739717204581
the best threshold is 0.123920386982
[('L3_S33_F3859', 224), ('L3_S30_F3754', 207), ('L3_S30_F3759', 201), ('L3_S30_F3809', 199), ('L3_S36_F3920', 188), ('L3_S30_F3744', 187), ('L3_S30_F3749', 182), ('L3_S30_F3554', 178), ('L3_S29_F3395', 177), ('L3_S33_F3865', 171), ('L3_S29_F3479', 170), ('L3_S30_F3804', 167), ('L0_S0_F20', 154), ('L3_S29_F3339', 150), ('L3_S30_F3769', 146), ('L3_S30_F3774', 143), ('S38_StationTiming', 139), ('L0_S1_F28', 128), ('S30_Mean', 123)]
this is fold 5
[0]	train-auc:0.662067	val-auc:0.651484
Multiple eval metrics have been passed: 'val-auc' will be used for early stopping.

Will train until val-auc hasn't improved in 20 rounds.
[10]	train-auc:0.752219	val-auc:0.712444
[20]	train-auc:0.782324	val-auc:0.725393
[30]	train-auc:0.796867	val-auc:0.730415
[40]	train-auc:0.810932	val-auc:0.732807
[50]	train-auc:0.821836	val-auc:0.734711
[60]	train-auc:0.830853	val-auc:0.736223
[70]	train-auc:0.843433	val-auc:0.736532
[80]	train-auc:0.850642	val-auc:0.737257
[90]	train-auc:0.860046	val-auc:0.738343
[100]	train-auc:0.86778	val-auc:0.739338
[110]	train-auc:0.873092	val-auc:0.73988
[120]	train-auc:0.881763	val-auc:0.739111
Stopping. Best iteration:
[109]	train-auc:0.872674	val-auc:0.740026

xgb mcc: 0.266756536295
the auc is 0.739487486059
the best threshold is 0.240507
the auc is 0.728526960791
rf mcc: 0.20879434493
the best threshold is 0.143831538859
final mcc: 0.260130656014
the auc is 0.742863982453
the best threshold is 0.222192102664
[('L3_S30_F3759', 226), ('L3_S33_F3857', 225), ('L3_S30_F3554', 223), ('L3_S30_F3774', 215), ('L3_S30_F3754', 208), ('L3_S36_F3920', 205), ('L3_S30_F3809', 202), ('L3_S30_F3749', 194), ('L3_S33_F3859', 191), ('L3_S30_F3744', 188), ('L3_S33_F3865', 187), ('L3_S30_F3769', 183), ('L0_S0_F20', 166), ('L3_S29_F3479', 161), ('L3_S29_F3336', 153), ('L3_S29_F3395', 148), ('L3_S29_F3339', 126), ('L3_S30_F3704', 126), ('L0_S1_F28', 126)]
In[11]: threshold3 = threshold3 / 5
threshold1 = threshold1 / 5
threshold2 = threshold2 / 5

In[12]: threshold2

Out[12]: 0.13899523998901958
In[13]: threshold1

Out[13]: 0.23973064720630646
In[14]: threshold3

Out[14]: 0.19159395311626598
In[15]: xgb_result_set1_test = xgb_result_set1_test/float(5)
rf_result_set1_test = rf_result_set1_test/float(5)
best_proba, best_mcc, y_pred = eval_mcc(train.Y.values, xgb_result_set1['pred'], True)
print("the xgb:",best_mcc)
best_proba, best_mcc, y_pred = eval_mcc(train.Y.values, rf_result_set1['pred'], True)
print("the rf:",best_mcc)
best_proba, best_mcc, y_pred = eval_mcc(train.Y.values, final_result_set1['pred'], True)
print("the xgb,rf:",best_mcc)

the xgb: 0.2680996981
the rf: 0.211444695414
the xgb,rf: 0.265162694781