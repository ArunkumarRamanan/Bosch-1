this is fold 1
[0]	train-auc:0.914043	val-auc:0.897427
Multiple eval metrics have been passed: 'val-auc' will be used for early stopping.

Will train until val-auc hasn't improved in 20 rounds.
[10]	train-auc:0.938357	val-auc:0.906375
[20]	train-auc:0.946931	val-auc:0.910078
[30]	train-auc:0.954017	val-auc:0.910562
[40]	train-auc:0.95907	val-auc:0.910676
Stopping. Best iteration:
[23]	train-auc:0.950508	val-auc:0.91103

xgb mcc: 0.411552108249
the auc is 0.910672008027
the best threshold is 0.371374
the auc is 0.902233701788
rf mcc: 0.395216749916
the best threshold is 0.223988508139
final mcc: 0.417678847583
the auc is 0.908163236457
the best threshold is 0.27285257566
[('Euc_dist_NF', 292), ('end_time', 282), ('mean_num_value', 273), ('tot_time', 226), ('Man_dist_NF', 219), ('sta_33m3', 187), ('sta_30m3', 184), ('magic5', 181), ('magic3', 176), ('magic4', 174), ('sta_34m3', 171), ('magic6', 170), ('sta_29m3', 166), ('lag200rate', 164), ('cluster_n500', 157), ('lead200rate', 147), ('sta_32m3', 144), ('lag200cnt', 142), ('max_num_value', 140)]
this is fold 2
[0]	train-auc:0.91119	val-auc:0.887879
Multiple eval metrics have been passed: 'val-auc' will be used for early stopping.

Will train until val-auc hasn't improved in 20 rounds.
[10]	train-auc:0.938534	val-auc:0.910214
[20]	train-auc:0.945085	val-auc:0.9117
[30]	train-auc:0.950508	val-auc:0.911128
[40]	train-auc:0.957205	val-auc:0.911346
Stopping. Best iteration:
[24]	train-auc:0.947356	val-auc:0.912086

xgb mcc: 0.418523495193
the auc is 0.91128998095
the best threshold is 0.410751
the auc is 0.906406996604
rf mcc: 0.392994996439
the best threshold is 0.303130959713
final mcc: 0.417046043711
the auc is 0.91015118822
the best threshold is 0.328976609663
[('end_time', 289), ('sta_33m3', 259), ('Euc_dist_NF', 255), ('tot_time', 227), ('Man_dist_NF', 226), ('mean_num_value', 215), ('magic3', 193), ('magic6', 182), ('lag200rate', 170), ('sta_30m3', 156), ('magic5', 153), ('lag200cnt', 143), ('cluster_n500', 143), ('sta_29m3', 142), ('sta_34m3', 138), ('sta_34m4', 130), ('lead200cnt', 128), ('unique_path', 123), ('min_num_feat', 121)]
this is fold 3
[0]	train-auc:0.91334	val-auc:0.899596
Multiple eval metrics have been passed: 'val-auc' will be used for early stopping.

Will train until val-auc hasn't improved in 20 rounds.
[10]	train-auc:0.937999	val-auc:0.914958
[20]	train-auc:0.945381	val-auc:0.91404
[30]	train-auc:0.951361	val-auc:0.915172
[40]	train-auc:0.95814	val-auc:0.915098
[50]	train-auc:0.966735	val-auc:0.915304
Stopping. Best iteration:
[32]	train-auc:0.953156	val-auc:0.915625

xgb mcc: 0.454098634488
the auc is 0.915239625257
the best threshold is 0.389251
the auc is 0.910879286733
rf mcc: 0.417302362766
the best threshold is 0.184822083099
final mcc: 0.453376128194
the auc is 0.914707257213
the best threshold is 0.27263125806
[('tot_time', 350), ('mean_num_value', 348), ('end_time', 316), ('Euc_dist_NF', 305), ('magic6', 287), ('Man_dist_NF', 247), ('sta_34m3', 239), ('magic5', 223), ('sta_33m3', 220), ('magic3', 201), ('cluster_n500', 199), ('sta_30m3', 195), ('unique_path', 182), ('min_num_value', 177), ('lag200rate', 175), ('magic4', 173), ('min_num_feat', 164), ('max_num_value', 156), ('sta_29m3', 156)]
this is fold 4
[0]	train-auc:0.916751	val-auc:0.905339
Multiple eval metrics have been passed: 'val-auc' will be used for early stopping.

Will train until val-auc hasn't improved in 20 rounds.
[10]	train-auc:0.938547	val-auc:0.916623
[20]	train-auc:0.945495	val-auc:0.917773
[30]	train-auc:0.951737	val-auc:0.918176
[40]	train-auc:0.960072	val-auc:0.918196
Stopping. Best iteration:
[23]	train-auc:0.948817	val-auc:0.918782

xgb mcc: 0.423321153315
the auc is 0.918135301332
the best threshold is 0.40292
the auc is 0.910886903878
rf mcc: 0.402780295435
the best threshold is 0.175804236375
final mcc: 0.42865083685
the auc is 0.91578438081
the best threshold is 0.220756907928
[('end_time', 251), ('tot_time', 249), ('mean_num_value', 246), ('Euc_dist_NF', 246), ('Man_dist_NF', 219), ('magic6', 211), ('sta_33m3', 186), ('magic3', 181), ('magic5', 176), ('sta_34m3', 171), ('cluster_n500', 162), ('magic4', 146), ('lag200rate', 146), ('sta_30m3', 146), ('sta_32m3', 140), ('unique_path', 136), ('sta_35m3', 135), ('min_num_value', 129), ('max_num_value', 125)]
this is fold 5
[0]	train-auc:0.913441	val-auc:0.899769
Multiple eval metrics have been passed: 'val-auc' will be used for early stopping.

Will train until val-auc hasn't improved in 20 rounds.
[10]	train-auc:0.939329	val-auc:0.91283
[20]	train-auc:0.945755	val-auc:0.914281
[30]	train-auc:0.952609	val-auc:0.915845
[40]	train-auc:0.959013	val-auc:0.916594
[50]	train-auc:0.966204	val-auc:0.916744
[60]	train-auc:0.970804	val-auc:0.916316
Stopping. Best iteration:
[47]	train-auc:0.964642	val-auc:0.917386

xgb mcc: 0.433535516883
the auc is 0.916694757784
the best threshold is 0.412068
the auc is 0.911935971865
rf mcc: 0.409101201736
the best threshold is 0.256033612114
final mcc: 0.435426003123
the auc is 0.916493851337
the best threshold is 0.330805630436
[('mean_num_value', 439), ('tot_time', 409), ('end_time', 402), ('Euc_dist_NF', 368), ('Man_dist_NF', 361), ('magic6', 332), ('sta_34m3', 292), ('sta_33m3', 288), ('magic3', 276), ('sta_30m3', 263), ('magic5', 246), ('sta_37m3', 237), ('sta_29m3', 237), ('min_num_value', 225), ('lead200cnt', 220), ('cluster_n500', 219), ('min_num_feat', 206), ('magic4', 205), ('lag200cnt', 205)]
In[24]: threshold3 = threshold3 / 5
threshold1 = threshold1 / 5
threshold2 = threshold2 / 5
xgb_result_set1_test = xgb_result_set1_test/float(5)
rf_result_set1_test = rf_result_set1_test/float(5)
best_proba, best_mcc, y_pred = eval_mcc(train.Y.values, xgb_result_set1['pred'], True)
print("the xgb:",best_mcc)
best_proba, best_mcc, y_pred = eval_mcc(train.Y.values, rf_result_set1['pred'], True)
print("the rf:",best_mcc)
best_proba, best_mcc, y_pred = eval_mcc(train.Y.values, final_result_set1['pred'], True)
print("the xgb,rf:",best_mcc)

the xgb: 0.426335288013
the rf: 0.398598877166
the xgb,rf: 0.42637722018